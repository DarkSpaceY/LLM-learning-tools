import{v as D,s as k,x as K,y as L,z as P,_ as le,f as t,i as se,j as _,r,o as d,a as p,b as n,t as i,u as l,d as e,w as o,k as ne,l as R,m as ce,A as re,e as m,F as A,g as E,E as U,p as b,q as F,B as ie}from"./index-b16f3770.js";import"./index-61e59391.js";import{a as ue}from"./axios-3a665b0f.js";const de=[{value:"video",label:"视频教程",icon:D},{value:"article",label:"文章",icon:k},{value:"document",label:"文档",icon:k},{value:"course",label:"在线课程",icon:K},{value:"book",label:"电子书",icon:L},{value:"tool",label:"工具",icon:P}],_e={video:"success",article:"info",document:"warning",course:"danger",book:"",tool:"primary"},q={video:D,article:k,document:k,course:K,book:L,tool:P};const pe={class:"resource-searcher-container"},me={class:"searcher-header"},fe={class:"description"},ye={class:"searcher-content"},ve={class:"input-section"},he={key:0,class:"result-section"},ge={class:"card-header"},be={class:"resources-list"},ke={class:"resource-header"},we={class:"title-section"},Ve={class:"resource-meta"},xe={class:"resource-description"},Ce={class:"pagination-container"},Se={key:1,class:"no-result"},ze={class:"suggestion"},Te={key:2,class:"loading-state"},Ue={__name:"ResourceSearcherView",setup(Be){const j=[t("入门"),t("基础"),t("进阶"),t("高级"),t("专家")],c=se({keyword:"",types:[],difficulty:0}),v=_(1),w=_(10),V=_(0),h=_(!1),g=_([]),x=_(!1),G=s=>{Array.isArray(s)?(c.types=s,console.log("已选择的资源类型:",c.types)):(console.warn("资源类型选择值无效:",s),c.types=[])},f=async()=>{if(!c.keyword.trim()){U.warning(t("请输入搜索关键词"));return}h.value=!0;try{const s=await ue.post("/api/resources/search",{query:c.keyword,types:c.types,difficulty:c.difficulty});if(s.data.success){const u=s.data.data.items.map(y=>({...y,url:y.url.replace(/`/g,"").trim()}));g.value=u,V.value=s.data.data.total,x.value=!0}else U.warning(s.data.message||t("搜索失败"))}catch(s){U.error(t("搜索失败，请稍后重试")),console.error("搜索失败:",s)}finally{h.value=!1}},H=s=>{w.value=s,f()},J=s=>{v.value=s,f()},O=s=>_e[s]||"info",Q=s=>q[s]||q.document,W=()=>{c.keyword="",c.types=[],c.difficulty=0,c.sort="relevance",v.value=1,x.value=!1,g.value=[]};return(s,u)=>{const y=r("el-button"),X=r("el-input"),C=r("el-form-item"),S=r("el-icon"),Y=r("el-checkbox"),Z=r("el-checkbox-group"),z=r("el-col"),B=r("el-rate"),I=r("el-row"),$=r("el-form"),M=r("el-tag"),ee=r("el-link"),N=r("el-card"),te=r("el-pagination"),oe=r("el-empty"),T=r("el-skeleton");return d(),p("div",pe,[n("div",me,[n("h2",null,i(l(t)("学习资源搜索器")),1),n("p",fe,i(l(t)("智能搜索优质学习资源，提供评分和标签分类")),1)]),n("div",ye,[n("div",ve,[e($,{model:c,"label-position":"top",onSubmit:ne(f,["prevent"])},{default:o(()=>[e(C,{label:l(t)("搜索关键词")},{default:o(()=>[e(X,{modelValue:c.keyword,"onUpdate:modelValue":u[0]||(u[0]=a=>c.keyword=a),placeholder:l(t)("请输入要搜索的关键词"),clearable:!0,onKeyup:ce(f,["enter"])},{append:o(()=>[e(y,{type:"primary",onClick:f,loading:h.value,icon:l(re)},{default:o(()=>[m(i(l(t)("搜索")),1)]),_:1},8,["loading","icon"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(I,{gutter:20},{default:o(()=>[e(z,{span:12},{default:o(()=>[e(C,{label:l(t)("资源类型")},{default:o(()=>[e(Z,{modelValue:c.types,"onUpdate:modelValue":u[1]||(u[1]=a=>c.types=a),onChange:G,class:"resource-type-checkboxes"},{default:o(()=>[(d(!0),p(A,null,E(l(de),a=>(d(),b(Y,{key:a.value,value:a.value},{default:o(()=>[e(S,null,{default:o(()=>[(d(),b(F(a.icon)))]),_:2},1024),m(" "+i(l(t)(a.label)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(z,{span:12},{default:o(()=>[e(C,{label:l(t)("难度等级")},{default:o(()=>[e(B,{modelValue:c.difficulty,"onUpdate:modelValue":u[2]||(u[2]=a=>c.difficulty=a),max:5,texts:j,"show-text":"","text-color":"#ff9900"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),g.value.length>0?(d(),p("div",he,[e(I,{gutter:20},{default:o(()=>[e(z,{span:24},{default:o(()=>[e(N,{class:"results-card",shadow:"hover"},{header:o(()=>[n("div",ge,[n("h4",null,i(l(t)("搜索结果")),1),e(M,{type:"success"},{default:o(()=>[m(i(l(t)("共找到 {0} 个资源",[V.value])),1)]),_:1})])]),default:o(()=>[n("div",be,[(d(!0),p(A,null,E(g.value,a=>(d(),b(N,{key:a.id,class:"resource-card",shadow:"hover"},{default:o(()=>[n("div",ke,[n("div",we,[e(ee,{href:a.url,target:"_blank",type:"primary",underline:!1},{default:o(()=>[n("h4",null,[e(S,null,{default:o(()=>[e(l(ie))]),_:1}),m(" "+i(a.title),1)])]),_:2},1032,["href"]),n("div",Ve,[e(M,{size:"small",type:O(a.type)},{default:o(()=>[e(S,null,{default:o(()=>[(d(),b(F(Q(a.type))))]),_:2},1024),m(" "+i(l(t)(a.type)),1)]),_:2},1032,["type"]),e(B,{modelValue:a.difficulty,"onUpdate:modelValue":ae=>a.difficulty=ae,disabled:"","show-score":"","text-color":"#ff9900"},null,8,["modelValue","onUpdate:modelValue"])])])]),n("p",xe,i(a.description),1)]),_:2},1024))),128)),n("div",Ce,[e(te,{"current-page":v.value,"onUpdate:currentPage":u[3]||(u[3]=a=>v.value=a),"page-size":w.value,"onUpdate:pageSize":u[4]||(u[4]=a=>w.value=a),total:V.value,"page-sizes":[10,20,30,50],background:!0,layout:"total, sizes, prev, pager, next",onSizeChange:H,onCurrentChange:J},null,8,["current-page","page-size","total"])])])]),_:1})]),_:1})]),_:1})])):x.value?(d(),p("div",Se,[e(oe,{image:s.emptyImage,description:l(t)("暂无搜索结果")},{description:o(()=>[n("p",null,i(l(t)("没有找到相关的学习资源")),1),n("p",ze,i(l(t)("建议尝试：")),1),n("ul",null,[n("li",null,i(l(t)("检查关键词是否正确")),1),n("li",null,i(l(t)("尝试使用不同的搜索词")),1),n("li",null,i(l(t)("减少筛选条件")),1)])]),default:o(()=>[e(y,{type:"primary",onClick:W},{default:o(()=>[m(i(l(t)("重置搜索")),1)]),_:1})]),_:1},8,["image","description"])])):R("",!0),h.value?(d(),p("div",Te,[e(T,{rows:3,animated:""}),e(T,{rows:3,animated:""}),e(T,{rows:3,animated:""})])):R("",!0)])])}}},Re=le(Ue,[["__scopeId","data-v-249abd92"]]);export{Re as default};
